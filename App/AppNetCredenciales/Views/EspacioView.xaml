<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:views="clr-namespace:AppNetCredenciales.Views"
             x:Class="AppNetCredenciales.Views.EspacioView"
             Title="Espacios">
    <Grid RowDefinitions="Auto,*,Auto" Padding="12" BackgroundColor="White">

        <!-- Row 0: Busy indicator -->
        <ActivityIndicator Grid.Row="0"
                           IsRunning="{Binding IsBusy}"
                           IsVisible="{Binding IsBusy}"
                           HorizontalOptions="Center"
                           Margin="0,6" />

        <!-- Row 1: CollectionView -->
        <CollectionView Grid.Row="1"
                        ItemsSource="{Binding Espacios}"
                        SelectionMode="None"
                        RemainingItemsThreshold="1"
                        Margin="0,6">
            <CollectionView.EmptyView>
                <Grid RowDefinitions="Auto,Auto" 
                      VerticalOptions="Center" 
                      HorizontalOptions="Center">
                    <Label Grid.Row="0"
                           Text="ðŸ¢"
                           FontSize="48" 
                           HorizontalOptions="Center"
                           Margin="0,0,0,12" />
                    <StackLayout Grid.Row="1" Spacing="6" HorizontalOptions="Center">
                        <Label Text="No hay espacios disponibles para ti" 
                               FontSize="20" 
                               HorizontalTextAlignment="Center" 
                               TextColor="#666" />
                        <Label Text="Los espacios disponibles aparecerÃ¡n aquÃ­." 
                               FontSize="14" 
                               HorizontalTextAlignment="Center" 
                               TextColor="#999" />
                    </StackLayout>
                </Grid>
            </CollectionView.EmptyView>

            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame Margin="6" 
                           Padding="12" 
                           CornerRadius="10" 
                           HasShadow="False" 
                           BorderColor="#ddd"
                           BackgroundColor="White">
                        <!-- âœ… Grid con filas: informaciÃ³n + botÃ³n -->
                        <Grid RowDefinitions="Auto,Auto" ColumnSpacing="0" RowSpacing="12">

                            <!-- Fila 0: InformaciÃ³n del espacio -->
                            <Grid Grid.Row="0" ColumnDefinitions="Auto,*" VerticalOptions="Center">
                                <!-- Icono del espacio -->
                                <Frame Grid.Column="0"
                                       WidthRequest="44" 
                                       HeightRequest="44" 
                                       CornerRadius="22" 
                                       BackgroundColor="#f0f0f0" 
                                       Padding="0" 
                                       VerticalOptions="Center">
                                    <Label Text="ðŸ¢" 
                                           HorizontalOptions="Center" 
                                           VerticalOptions="Center" 
                                           FontSize="18" />
                                </Frame>

                                <!-- InformaciÃ³n del espacio -->
                                <StackLayout Grid.Column="1" 
                                           Padding="12,0" 
                                           VerticalOptions="Center"
                                           Spacing="2">
                                    <Label Text="{Binding Nombre}" 
                                           FontAttributes="Bold" 
                                           FontSize="16" 
                                           LineBreakMode="TailTruncation" 
                                           TextColor="#333" />
                                    <Label Text="{Binding Tipo}" 
                                           FontSize="12" 
                                           TextColor="Gray" 
                                           LineBreakMode="TailTruncation" />
                                    <Label Text="{Binding Activo, StringFormat='Estado: {0}'}" 
                                           FontSize="11" 
                                           TextColor="#666" 
                                           LineBreakMode="TailTruncation" />
                                </StackLayout>
                            </Grid>

                            <!-- âœ… Fila 1: BotÃ³n Ãºnico centrado -->
                            <Button Grid.Row="1"
                                    Text="ðŸ“‹ Ver Perfil" 
                                    FontSize="16"
                                    BackgroundColor="#2196F3"
                                    TextColor="White"
                                    CornerRadius="8"
                                    HeightRequest="40"
                                    Margin="0,4,0,0"
                                    Clicked="OnVerPerfilClicked"
                                    CommandParameter="{Binding}" />
                        </Grid>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

        <!-- Row 2: Navbar -->
        <views:Navbar Grid.Row="2" />
    </Grid>
</ContentPage>