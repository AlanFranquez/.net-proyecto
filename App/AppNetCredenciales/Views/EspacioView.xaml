<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:views="clr-namespace:AppNetCredenciales.Views"
             x:Class="AppNetCredenciales.Views.EspacioView"
             Title="Espacios">
    <Grid RowDefinitions="Auto,*,Auto" Padding="12" BackgroundColor="White">
        <!-- Top: Busy indicator -->
        <ActivityIndicator Grid.Row="0"
                       IsRunning="{Binding IsBusy}"
                       IsVisible="{Binding IsBusy}"
                       HorizontalOptions="Center"
                       Margin="0,6" />

        <CollectionView 
                    ItemsSource="{Binding Espacios}"
                    SelectionChanged="OnEspacioSelected"
                    SelectionMode="Single"
                    RemainingItemsThreshold="1"
                    Margin="0,6">
            <CollectionView.EmptyView>
                <StackLayout VerticalOptions="CenterAndExpand" HorizontalOptions="CenterAndExpand" Spacing="6">
                    <Label Text="No hay registros aÃºn" FontSize="20" HorizontalTextAlignment="Center" TextColor="#666" />
                    <Label Text="AquÃ­ verÃ¡s tus accesos cuando se registren" FontSize="14" HorizontalTextAlignment="Center" TextColor="#999" />
                </StackLayout>
            </CollectionView.EmptyView>

            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame Margin="6" Padding="12" CornerRadius="10" HasShadow="False" BorderColor="#ddd">
                        <Grid ColumnDefinitions="Auto,*,Auto" VerticalOptions="Center">
                            <!-- Placeholder icon circle -->
                            <Frame WidthRequest="44" HeightRequest="44" CornerRadius="22" BackgroundColor="#f0f0f0" Padding="0" VerticalOptions="Center">
                                <Label Text="ðŸ·" HorizontalOptions="Center" VerticalOptions="Center" />
                            </Frame>

                            <!-- Texts -->
                            <StackLayout Grid.Column="1" Padding="8,0" VerticalOptions="Center">
                                <Label Text="{Binding Nombre}" FontAttributes="Bold" FontSize="16" LineBreakMode="TailTruncation" />
                                <Label Text="{Binding Descripcion}" FontSize="12" TextColor="white" LineBreakMode="TailTruncation" />
                                <Label Text="{Binding Tipo}" FontSize="12" TextColor="white" LineBreakMode="TailTruncation" />
                                <Label Text="{Binding Activo}" FontSize="12" TextColor="white" LineBreakMode="TailTruncation" />
                            </StackLayout>
                            <Label Grid.Column="2" Text="{Binding EspacioId}" FontSize="12" TextColor="#999" VerticalOptions="Center" HorizontalOptions="End" />
                        </Grid>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

        <!-- Bottom: Navbar - Changed from Grid.Row="1" to Grid.Row="2" -->
        <views:Navbar Grid.Row="1" />
    </Grid>
</ContentPage>